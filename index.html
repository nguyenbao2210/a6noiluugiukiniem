<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Nơi lưu giữ kỉ niệm A6 niên khóa 2021-2025</title>
  <style>
    body {
      background-image: url('d4465b16-5a30-4307-8648-55c78a2eaeb6.png');
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      min-height: 100vh;
      margin: 0;
      font-family: Arial, sans-serif;
      color: white;
      text-shadow: 1px 1px 2px #000;
    }

    .container {
      background: rgba(0, 0, 0, 0.4);
      padding: 20px;
      max-width: 700px;
      margin: 0 auto;
      border-radius: 10px;
      margin-top: 30px;
    }

    h1, h2 {
      text-align: center;
    }

    #messageList {
      margin-top: 20px;
    }

    .message {
      background-color: rgba(255, 255, 255, 0.1);
      padding: 12px;
      margin-bottom: 10px;
      border-radius: 6px;
      border-left: 4px solid #4CAF50;
    }

    .message strong {
      font-size: 16px;
      color: #fff;
    }

    .message p {
      margin: 4px 0;
      font-size: 15px;
      color: #ddd;
    }

    .timestamp {
      font-size: 12px;
      color: #ccc;
    }

    input, button {
      padding: 8px;
      border: none;
      border-radius: 4px;
      font-size: 16px;
    }

    #submitBtn {
      margin-left: 8px;
      background-color: #4CAF50;
      color: white;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }

    #submitBtn:disabled {
      background-color: #888;
      cursor: not-allowed;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Nơi lưu giữ kỉ niệm A6 niên khóa 2021-2025</h1>
    <p style="text-align: center; font-style: italic;">
      Đã 1 khoảng thời gian trôi qua và chúng ta đều có cho mình những kỉ niệm đẹp cùng nhau. Nhưng có thể sau này sẽ không còn gặp nhau được nữa. Khi nghĩ về điều đó, mỗi chúng ta đều có suy nghĩ và cảm xúc khác nhau. Và tại đây, tôi mong muốn có thể được nghe cảm xúc thật của các bạn về khoảng thời gian cấp 2 đầy đẹp đẽ này.
    </p>

    <h2>Gửi lời nhắn</h2>
    <input type="text" id="nameInput" placeholder="Tên của bạn...">
    <input type="text" id="messageInput" placeholder="Nhập lời nhắn...">
    <button id="submitBtn">Gửi</button>

    <h2>Cảm xúc của mọi người</h2>
    <div id="messageList"></div>
  </div>

  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js"></script>
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyAhsQAGuHcWJs79kl49AJClCvEbzcqob30",
      authDomain: "a6noiluugiunhungkiniem.firebaseapp.com",
      projectId: "a6noiluugiunhungkiniem",
      storageBucket: "a6noiluugiunhungkiniem.appspot.com",
      messagingSenderId: "834977276667",
      appId: "1:834977276667:web:704f0a898394e3744ec65e",
      measurementId: "G-GHK2V4XZ38"
    };

    const app = firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    const submitBtn = document.getElementById("submitBtn");
    const nameInput = document.getElementById("nameInput");
    const messageInput = document.getElementById("messageInput");

    submitBtn.addEventListener("click", async function () {
      const name = nameInput.value.trim();
      const msg = messageInput.value.trim();

      if (!name || !msg) {
        alert("Vui lòng nhập tên và lời nhắn.");
        return;
      }

      submitBtn.disabled = true;
      submitBtn.textContent = "Đang gửi...";

      try {
        await db.collection("messages").add({
          name: name,
          content: msg,
          timestamp: new Date()
        });

        messageInput.value = "";
        alert("Gửi thành công!");
      } catch (error) {
        console.error("Lỗi khi gửi tin nhắn:", error);
        alert("Đã xảy ra lỗi khi gửi lời nhắn. Vui lòng thử lại.");
      } finally {
        submitBtn.disabled = false;
        submitBtn.textContent = "Gửi";
      }
    });

    function formatDate(date) {
      return new Date(date.seconds * 1000).toLocaleString("vi-VN");
    }

    function loadMessages() {
      db.collection("messages").orderBy("timestamp", "desc").onSnapshot(snapshot => {
        const container = document.getElementById("messageList");
        container.innerHTML = "";
        snapshot.forEach(doc => {
          const data = doc.data();
          const div = document.createElement("div");
          div.className = "message";
          div.innerHTML = `
            <strong>${data.name}</strong>
            <p>${data.content}</p>
            <div class="timestamp">${formatDate(data.timestamp)}</div>
          `;
          container.appendChild(div);
        });
      });
    }

    loadMessages();
  </script>
</body>
</html>
